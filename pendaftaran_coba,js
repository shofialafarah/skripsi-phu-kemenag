// Update Date and Time
function updateDateTime() {
    const now = new Date();
    
    // Format date: Kamis, 1 Mei 2025
    const options = { 
        weekday: 'long', 
        day: 'numeric', 
        month: 'long', 
        year: 'numeric' 
    };
    
    const dateFormatted = now.toLocaleDateString('id-ID', options);
    document.getElementById('currentDate').textContent = dateFormatted;
    
    // Format time: HH:MM:SS
    const timeFormatted = now.toLocaleTimeString('id-ID', { 
        hour: '2-digit', 
        minute: '2-digit', 
        second: '2-digit',
        hour12: false 
    });
    document.getElementById('currentTime').textContent = timeFormatted;
}

// Update the time every second
setInterval(updateDateTime, 1000);
updateDateTime(); // Initial call

// Add event listeners for handling staff information
document.addEventListener('DOMContentLoaded', function() {
    // You can fetch staff name from session or API here
    // For example: fetchStaffInfo();
    
    // For demonstration, we'll just use the default name
    // setupDashboardData();
    
    // Add event listeners to action buttons
    setupActionButtons();
});

// Simulate API call for dashboard data
function setupDashboardData() {
    // In a real application, you would fetch this data from your backend
    // Example: fetchDashboardStats().then(updateDashboardStats);
    
    // For now, we'll use the example data already in HTML
}

// Handle verification button clicks
function setupActionButtons() {
    const actionButtons = document.querySelectorAll('.action-button');
    
    actionButtons.forEach(button => {
        button.addEventListener('click', function(e) {
            const row = e.target.closest('tr');
            const name = row.querySelector('td:nth-child(3)').textContent;
            
            // Show confirmation dialog (could be replaced with a modal)
            if (confirm(`Verifikasi data untuk ${name}?`)) {
                // In a real app, you would call an API here
                // For demo purposes, we'll just remove the row
                row.style.backgroundColor = '#e8f5e9';
                e.target.textContent = 'Terverifikasi';
                e.target.disabled = true;
                e.target.classList.add('verified');
                
                // Update counters in a real application
                updateCounters();
            }
        });
    });
}

// Simple counter updates for demonstration
function updateCounters() {
    // Get current counts
    let pendingTotal = parseInt(document.getElementById('totalPending').textContent);
    let verifiedToday = parseInt(document.getElementById('verifiedToday').textContent);
    
    // Update counts
    document.getElementById('totalPending').textContent = pendingTotal - 1;
    document.getElementById('verifiedToday').textContent = verifiedToday + 1;
}

// Sidebar integration - adjust dashboard container based on sidebar state
const sidebarElement = document.querySelector('.sidebar');
const dashboardContainer = document.querySelector('.dashboard-container');

// Monitor sidebar changes with a MutationObserver
const observer = new MutationObserver(function(mutations) {
    mutations.forEach(function(mutation) {
        if (mutation.attributeName === 'class') {
            if (sidebarElement.classList.contains('open')) {
                dashboardContainer.style.marginLeft = '280px';
            } else {
                dashboardContainer.style.marginLeft = '84px';
            }
        }
    });
});

// Start observing the sidebar for class changes
if (sidebarElement && dashboardContainer) {
    observer.observe(sidebarElement, { attributes: true });
    
    // Set initial state
    if (sidebarElement.classList.contains('open')) {
        dashboardContainer.style.marginLeft = '280px';
    } else {
        dashboardContainer.style.marginLeft = '84px';
    }
}

// Add notification functionality (optional)
function showNotification(message, type = 'info') {
    // Create notification element
    const notification = document.createElement('div');
    notification.className = `notification ${type}`;
    notification.textContent = message;
    
    // Add to page
    document.body.appendChild(notification);
    
    // Show with animation
    setTimeout(() => {
        notification.classList.add('show');
    }, 10);
    
    // Auto remove after 5 seconds
    setTimeout(() => {
        notification.classList.remove('show');
        setTimeout(() => {
            notification.remove();
        }, 300);
    }, 5000);
}

// Simulate new data arriving (for demonstration)
setTimeout(() => {
    showNotification('Data baru: 3 pendaftaran baru perlu diverifikasi', 'info');
}, 10000); // Show notification after 10 seconds for demo

function searchJamaah() {
    var input = document.getElementById('searchInput').value.toLowerCase();
    var jamaahList = document.querySelectorAll('.jamaah-item'); // Ini selector untuk elemen yang berisi data jamaah
  
    jamaahList.forEach(function(jamaah) {
      var namaJamaah = jamaah.textContent.toLowerCase();
      if (namaJamaah.includes(input)) {
        jamaah.style.display = 'block';  // Menampilkan item yang cocok
      } else {
        jamaah.style.display = 'none';   // Menyembunyikan item yang tidak cocok
      }
    });
  }
  